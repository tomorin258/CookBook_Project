<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="dao.mappers.RecipeIngredientsMapper">

    <resultMap id="RecipeIngredientsResultMap" type="model.RecipeIngredients">
        <id property="recipeId" column="recipe_id" />
        <id property="ingredientId" column="ingredient_id" />
        <result property="amount" column="amount" />
        <result property="unit" column="unit" />
    </resultMap>

    <insert id="addRecipeIngredients" parameterType="model.RecipeIngredients">
        INSERT INTO recipe_ingredients (recipe_id, ingredient_id, amount, unit, description)
        VALUES (#{recipeId}, #{ingredientId}, #{amount}, #{unit}, #{description})
    </insert>

    <delete id="deleteRecipeIngredients" parameterType="map">
        DELETE FROM recipe_ingredients
        WHERE recipe_id = #{recipeId} AND ingredient_id = #{ingredientId}
    </delete>

    <update id="updateRecipeIngredients" parameterType="model.RecipeIngredients">
        UPDATE recipe_ingredients
        SET amount = #{amount},
            unit = #{unit},
            description = #{description}
        WHERE recipe_id = #{recipeId} AND ingredient_id = #{ingredientId}
    </update>

    <select id="getRecipeIngredientsById" resultMap="RecipeIngredientsResultMap">
        SELECT recipe_id, ingredient_id, amount, unit, description
        FROM recipe_ingredients
        WHERE recipe_id = #{recipeId} AND ingredient_id = #{ingredientId}
    </select>

    <select id="getRecipeIngredientsByRecipeId" resultMap="RecipeIngredientsResultMap">
        SELECT recipe_id, ingredient_id, amount, unit, description
        FROM recipe_ingredients
        WHERE recipe_id = #{recipeId}
    </select>

    <select id="getRecipeIngredientsByIngredientId" resultMap="RecipeIngredientsResultMap">
        SELECT recipe_id, ingredient_id, amount, unit, description
        FROM recipe_ingredients
        WHERE ingredient_id = #{ingredientId}
    </select>

</mapper>